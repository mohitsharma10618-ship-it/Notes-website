{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">ğŸ“š All Notes</h2>
    {% if user.is_authenticated %}
    <a href="{% url 'upload_note' %}" class="btn btn-primary">
      <span>â•</span> Upload Note
    </a>
    {% endif %}
  </div>

  <div class="search-form">
    <form method="get">
      <div class="row g-3">
        <!-- Title / Subject search -->
        <div class="col-md-5">
          <input class="form-control" type="text" name="search"
                 placeholder="ğŸ” Search by title or subject"
                 value="{{ query }}">
        </div>

        <!-- Course search (text box) -->
        <div class="col-md-4">
          <input class="form-control" type="text" name="course"
                 placeholder="ğŸ“– Search by course"
                 value="{{ course_query }}">
        </div>

        <div class="col-md-3">
          <button class="btn btn-primary w-100" type="submit">
            <span>ğŸ”</span> Search
          </button>
        </div>
      </div>
    </form>
  </div>

  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th>ğŸ“„ Title</th>
          <th>ğŸ“š Course</th>
          <th>ğŸ“– Subject</th>
          <th>ğŸ“ Semester</th>
          <th>ğŸ‘¤ Uploaded By</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for note in notes %}
        <tr>
          <td><a href="{% url 'view_note' note.id %}"><strong>{{ note.title }}</strong></a></td>
          <td><span class="badge bg-info">{{ note.course|default:"N/A" }}</span></td>
          <td>{{ note.subject|default:"N/A" }}</td>
          <td>{% if note.semester %}{{ note.semester }}{% else %}N/A{% endif %}</td>
          <td><small class="text-secondary">@{{ note.uploaded_by.username }}</small></td>
          <td>
            <div class="d-flex gap-2">
              <a class="btn btn-sm btn-primary" href="{% url 'view_note' note.id %}">ğŸ‘ï¸ View</a>
              {% if note.upload %}
              <a class="btn btn-sm btn-success" href="{% url 'download_note' note.id %}">â¬‡ï¸ Download</a>
              {% endif %}
            </div>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="text-center py-5">
            <div class="text-muted">
              <h5>ğŸ“­ No notes found</h5>
              <p>Try adjusting your search criteria or upload a new note!</p>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}